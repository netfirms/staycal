{% extends 'base.html' %}
{% block content %}
<h1 class="text-2xl font-semibold mb-4">{{ 'New' if mode == 'new' else 'Edit' }} Booking</h1>
<div class="bg-white p-4 rounded-xl shadow-sm border max-w-2xl">
  <form method="post" action="{{ '/app/bookings/new' if mode == 'new' else '/app/bookings/' ~ booking.id ~ '/edit' }}" class="grid md:grid-cols-2 gap-4">
    <div>
      <label class="block text-sm font-medium">Room</label>
      <select name="room_id" class="border rounded w-full p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
        {% for r in rooms %}
          {% set sel = '' %}
          {% if booking and booking.room_id == r.id %}
            {% set sel = 'selected' %}
          {% elif selected_room_id and selected_room_id == r.id %}
            {% set sel = 'selected' %}
          {% endif %}
          <option value="{{ r.id }}" {{ sel }}>{{ r.name }}</option>
        {% endfor %}
      </select>
    </div>
    <div>
      <label class="block text-sm font-medium">Guest Name</label>
      <input name="guest_name" class="border rounded w-full p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" value="{{ booking.guest_name if booking else '' }}" required />
    </div>
    <div>
      <label class="block text-sm font-medium">Guest Contact</label>
      <input name="guest_contact" class="border rounded w-full p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" value="{{ booking.guest_contact if booking else '' }}" />
    </div>
    <div>
      <label class="block text-sm font-medium">Start Date</label>
      <input type="date" name="start_date" class="border rounded w-full p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" value="{{ booking.start_date.isoformat() if booking else '' }}" required />
    </div>
    <div>
      <label class="block text-sm font-medium">End Date</label>
      <input type="date" name="end_date" class="border rounded w-full p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" value="{{ booking.end_date.isoformat() if booking else '' }}" required />
    </div>
    <div>
      <label class="block text-sm font-medium">Price (THB)</label>
      <input type="number" step="0.01" name="price" class="border rounded w-full p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" value="{{ booking.price if booking else '' }}" />
    </div>
    <div>
      <label class="block text-sm font-medium">Status</label>
      <select name="status" class="border rounded w-full p-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
        {% for st in BookingStatus %}
          <option value="{{ st.value }}">{{ st.value }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="md:col-span-2 flex items-center gap-2">
      <a href="/app/bookings/" class="px-3 py-2 border rounded">Cancel</a>
      <button class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Save</button>
    </div>
  </form>
</div>
{% endblock %}
